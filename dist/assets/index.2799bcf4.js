var Oe=Object.defineProperty,$e=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var se=Object.getOwnPropertySymbols;var Ue=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var ce=(e,t,n)=>t in e?Oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,I=(e,t)=>{for(var n in t||(t={}))Ue.call(t,n)&&ce(e,n,t[n]);if(se)for(var n of se(t))je.call(t,n)&&ce(e,n,t[n]);return e},re=(e,t)=>$e(e,Pe(t));var ie=(e,t,n)=>new Promise((y,A)=>{var S=p=>{try{g(n.next(p))}catch(C){A(C)}},s=p=>{try{g(n.throw(p))}catch(C){A(C)}},g=p=>p.done?y(p.value):Promise.resolve(p.value).then(S,s);g((n=n.apply(e,t)).next())});import{eK as Re,eL as Ve,eM as me,eN as He,eO as Ye,eP as Xe,e8 as ze,ee as de,eQ as qe,eR as Ge,eS as Je,eT as We,a as Le,s as be,eU as Ze,c as Qe,f as M,a6 as $,o as F,h as U,i as r,aA as et,k as O,j as G,y as j,z as oe,t as ue,dG as tt,q as he,n as b,eV as nt,F as W,az as lt,cf as at,aB as st,aC as ct,eW as rt,b7 as it,b6 as Z,bl as dt,cG as ot,bt as ut,eX as ht,bS as ft,ag as Q,eY as fe,v as ye,ak as Y,dk as yt,an as kt,aw as J,eZ as gt,em as pt,L as R,N as St,e_ as Kt,dD as xt,cB as Lt,b0 as bt,w as ke,x as ge,bE as At,ax as Ct,e5 as pe,e$ as vt,bq as Se,cC as Et}from"./index.976f028d.js";import{b as Tt}from"./index.a30387ae.js";import{u as _t}from"./useContextMenu.fe08b0c6.js";import{g as Nt}from"./get.177428c4.js";var Bt=200;function wt(e,t,n,y){var A=-1,S=He,s=!0,g=e.length,p=[],C=t.length;if(!g)return p;n&&(t=Re(t,Ve(n))),y?(S=Ye,s=!1):t.length>=Bt&&(S=Xe,s=!1,t=new me(t));e:for(;++A<g;){var c=e[A],o=n==null?c:n(c);if(c=y||c!==0?c:0,s&&o===o){for(var l=C;l--;)if(t[l]===o)continue e;p.push(c)}else S(t,o,y)||p.push(c)}return p}var Dt=ze(function(e,t){return de(e)?wt(e,qe(t,1,de,!0)):[]}),Ft=Dt;function Mt(e){for(var t=-1,n=e==null?0:e.length,y={};++t<n;){var A=e[t];y[A[0]]=A[1]}return y}function ee(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((n,y)=>n+ee(e,y),""):Object.keys(t).reduce((n,y)=>n+(t[y]?ee(e,y):""),""):""}function It(e){return(t,n)=>(t&&typeof t!="string"&&(n=t,t=""),t=t?`${e}__${t}`:e,`${t}${ee(t,n)}`)}function Ae(e){return[It(`${Ge}-${e}`)]}const Ke=Symbol(),xe=Symbol();function Ot(e,t){if(!Je(e)||!!e[xe])return e;const{values:n,required:y,default:A,type:S,validator:s}=e,g=n||s?p=>{let C=!1,c=[];if(n&&(c=[...n,A],C||(C=c.includes(p))),s&&(C||(C=s(p))),!C&&c.length>0){const o=[...new Set(c)].map(l=>JSON.stringify(l)).join(", ");We(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${o}], got value ${JSON.stringify(p)}.`)}return C}:void 0;return{type:typeof S=="object"&&Object.getOwnPropertySymbols(S).includes(Ke)?S[Ke]:S,required:!!y,default:A,validator:g,[xe]:!0}}const $t=e=>Mt(Object.entries(e).map(([t,n])=>[t,Ot(n,t)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const Pt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],Ut=$t({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}}),jt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Rt=Le({props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const n=e,y=be(""),[A]=Ae("tree-header"),S=Ze(),{t:s}=Qe(),g=M(()=>{const l=S.headerTitle||n.title;return["mr-1","w-full",{["ml-5"]:l}]}),p=M(()=>{const{checkable:l}=n,i=[{label:s("component.tree.expandAll"),value:T.EXPAND_ALL},{label:s("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:l}];return l?[{label:s("component.tree.selectAll"),value:T.SELECT_ALL},{label:s("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:l},...i,{label:s("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:s("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:i});function C(l){var d,h,u,k;const{key:i}=l;switch(i){case T.SELECT_ALL:(d=n.checkAll)==null||d.call(n,!0);break;case T.UN_SELECT_ALL:(h=n.checkAll)==null||h.call(n,!1);break;case T.EXPAND_ALL:(u=n.expandAll)==null||u.call(n,!0);break;case T.UN_EXPAND_ALL:(k=n.expandAll)==null||k.call(n,!1);break;case T.CHECK_STRICTLY:t("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function c(l){t("search",l)}const o=ut(c,200);return $(()=>y.value,l=>{o(l)}),$(()=>n.searchText,l=>{l!==y.value&&(y.value=l)}),(l,i)=>(F(),U("div",{class:he([r(A)(),"flex px-2 py-1.5 items-center"])},[r(S).headerTitle?et(l.$slots,"headerTitle",{key:0}):O("",!0),!r(S).headerTitle&&l.title?(F(),G(r(tt),{key:1,helpMessage:l.helpMessage},{default:j(()=>[oe(ue(l.title),1)]),_:1},8,["helpMessage"])):O("",!0),l.search||l.toolbar?(F(),U("div",jt,[l.search?(F(),U("div",{key:0,class:he(r(g))},[b(r(nt),{placeholder:r(s)("common.searchText"),size:"small",allowClear:"",value:y.value,"onUpdate:value":i[0]||(i[0]=d=>y.value=d)},null,8,["placeholder","value"])],2)):O("",!0),l.toolbar?(F(),G(r(ot),{key:1,onClick:i[1]||(i[1]=dt(()=>{},["prevent"]))},{overlay:j(()=>[b(r(it),{onClick:C},{default:j(()=>[(F(!0),U(W,null,lt(r(p),d=>(F(),U(W,{key:d.value},[b(r(at),st(ct({key:d.value})),{default:j(()=>[oe(ue(d.label),1)]),_:2},1040),d.divider?(F(),G(r(rt),{key:0})):O("",!0)],64))),128))]),_:1})]),default:j(()=>[b(r(Z),{icon:"ion:ellipsis-vertical"})]),_:1})):O("",!0)])):O("",!0)],2))}}),Vt=({icon:e})=>e?ht(e)?ft(Z,{icon:e,class:"mr-1"}):Z:null;function mt(e,t){function n(c){const o=[],l=c||r(e),{key:i,children:d}=r(t);if(!d||!i)return o;for(let h=0;h<l.length;h++){const u=l[h];o.push(u[i]);const k=u[d];k&&k.length&&o.push(...n(k))}return o}function y(c){const o=[],l=c||r(e),{key:i,children:d}=r(t);if(!d||!i)return o;for(let h=0;h<l.length;h++){const u=l[h];u.disabled!==!0&&u.selectable!==!1&&o.push(u[i]);const k=u[d];k&&k.length&&o.push(...y(k))}return o}function A(c,o){const l=[],i=o||r(e),{key:d,children:h}=r(t);if(!h||!d)return l;for(let u=0;u<i.length;u++){const k=i[u],E=k[h];c===k[d]?(l.push(k[d]),E&&E.length&&l.push(...n(E))):E&&E.length&&l.push(...A(c,E))}return l}function S(c,o,l){if(!c)return;const i=l||r(e),{key:d,children:h}=r(t);if(!(!h||!d))for(let u=0;u<i.length;u++){const k=i[u],E=k[h];if(k[d]===c){i[u]=I(I({},i[u]),o);break}else E&&E.length&&S(c,o,k[h])}}function s(c=1,o,l=1){if(!c)return[];const i=[],d=o||r(e)||[];for(let h=0;h<d.length;h++){const u=d[h],{key:k,children:E}=r(t),X=k?u[k]:"",P=E?u[E]:[];i.push(X),P&&P.length&&l<c&&(l+=1,i.push(...s(c,P,l)))}return i}function g({parentKey:c=null,node:o,push:l="push"}){const i=Q(r(e));if(!c){i[l](o),e.value=i;return}const{key:d,children:h}=r(t);!h||!d||(fe(i,u=>{if(u[d]===c)return u[h]=u[h]||[],u[h][l](o),!0}),e.value=i)}function p({parentKey:c=null,list:o,push:l="push"}){const i=Q(r(e));if(!(!o||o.length<1))if(c){const{key:d,children:h}=r(t);if(!h||!d)return;fe(i,u=>{if(u[d]===c){u[h]=u[h]||[];for(let k=0;k<o.length;k++)u[h][l](o[k]);return e.value=i,!0}})}else for(let d=0;d<o.length;d++)i[l](o[d])}function C(c,o){if(!c)return;const l=o||r(e),{key:i,children:d}=r(t);if(!(!d||!i))for(let h=0;h<l.length;h++){const u=l[h],k=u[d];if(u[i]===c){l.splice(h,1);break}else k&&k.length&&C(c,u[d])}}return{deleteNodeByKey:C,insertNodeByKey:g,insertNodesByKey:p,filterByLevel:s,updateNodeByKey:S,getAllKeys:n,getChildrenKeys:A,getEnabledKeys:y}}function Ht(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!Lt(e)}var Jt=Le({name:"BasicTree",inheritAttrs:!1,props:Ut,emits:Pt,setup(e,{attrs:t,slots:n,emit:y,expose:A}){const[S]=Ae("tree"),s=ye({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),g=ye({startSearch:!1,searchText:"",searchData:[]}),p=be([]),[C]=_t(),c=M(()=>{const{fieldNames:a}=e;return I({children:"children",title:"title",key:"key"},a)}),o=M(()=>{let a=re(I(I({blockNode:!0},t),e),{expandedKeys:s.expandedKeys,selectedKeys:s.selectedKeys,checkedKeys:s.checkedKeys,checkStrictly:s.checkStrictly,filedNames:r(c),"onUpdate:expandedKeys":f=>{s.expandedKeys=f,y("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{s.selectedKeys=f,y("update:selectedKeys",f)},onCheck:(f,x)=>{let K=Y(s.checkedKeys);if(yt(K)&&g.startSearch){const{key:v}=r(c);K=Ft(K,P(x.node.$attrs.node[v])),x.checked&&K.push(x.node.$attrs.node[v]),s.checkedKeys=K}else s.checkedKeys=f;const L=Y(s.checkedKeys);y("update:value",L),y("check",L,x)},onRightClick:Ee});return kt(a,"treeData","class")}),l=M(()=>g.startSearch?g.searchData:r(p)),i=M(()=>!l.value||l.value.length===0),{deleteNodeByKey:d,insertNodeByKey:h,insertNodesByKey:u,filterByLevel:k,updateNodeByKey:E,getAllKeys:X,getChildrenKeys:P,getEnabledKeys:Ce}=mt(p,c);function ve(a,f){return!f&&e.renderIcon&&J(e.renderIcon)?e.renderIcon(a):f}function Ee(x){return ie(this,arguments,function*({event:a,node:f}){var B;const{rightMenuList:K=[],beforeRightClick:L}=e;let v={event:a,items:[]};if(L&&J(L)){let N=yield L(f,a);Array.isArray(N)?v.items=N:Object.assign(v,N)}else v.items=K;!((B=v.items)!=null&&B.length)||C(v)})}function V(a){s.expandedKeys=a}function Te(){return s.expandedKeys}function te(a){s.selectedKeys=a}function _e(){return s.selectedKeys}function ne(a){s.checkedKeys=a}function Ne(){return s.checkedKeys}function le(a){s.checkedKeys=a?Ce():[]}function z(a){s.expandedKeys=a?X():[]}function Be(a){s.checkStrictly=a}$(()=>e.searchValue,a=>{a!==g.searchText&&(g.searchText=a)},{immediate:!0}),$(()=>e.treeData,a=>{a&&q(g.searchText)});function q(a){if(a!==g.searchText&&(g.searchText=a),y("update:searchValue",a),!a){g.startSearch=!1;return}const{filterFn:f,checkable:x,expandOnSearch:K,checkOnSearch:L,selectedOnSearch:v}=r(e);g.startSearch=!0;const{title:B,key:N}=r(c),w=[];if(g.searchData=gt(r(p),_=>{var m,H;const D=f?f(a,_,r(c)):(H=(m=_[B])==null?void 0:m.includes(a))!=null?H:!1;return D&&w.push(_[N]),D},r(c)),K){const _=pt(g.searchData).map(D=>D[N]);_&&_.length&&V(_)}L&&x&&w.length&&ne(w),v&&w.length&&te(w)}function we(a,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!s.expandedKeys.includes(a))V([...s.expandedKeys,a]);else{const x=[...s.expandedKeys],K=x.findIndex(L=>L===a);K!==-1&&x.splice(K,1),V(x)}}R(()=>{p.value=e.treeData}),St(()=>{const a=parseInt(e.defaultExpandLevel);a>0?s.expandedKeys=k(a):e.defaultExpandAll&&z(!0)}),R(()=>{s.expandedKeys=e.expandedKeys}),R(()=>{s.selectedKeys=e.selectedKeys}),R(()=>{s.checkedKeys=e.checkedKeys}),$(()=>e.value,()=>{s.checkedKeys=Y(e.value||[])}),$(()=>s.checkedKeys,()=>{const a=Y(s.checkedKeys);y("update:value",a),y("change",a)}),R(()=>{s.checkStrictly=e.checkStrictly});const De={setExpandedKeys:V,getExpandedKeys:Te,setSelectedKeys:te,getSelectedKeys:_e,setCheckedKeys:ne,getCheckedKeys:Ne,insertNodeByKey:h,insertNodesByKey:u,deleteNodeByKey:d,updateNodeByKey:E,checkAll:le,expandAll:z,filterByLevel:a=>{s.expandedKeys=k(a)},setSearchValue:a=>{q(a)},getSearchValue:()=>g.searchText};function Fe(a){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((x,K)=>{var v;let L=!0;return J(x.show)?L=(v=x.show)==null?void 0:v.call(x,a):Se(x.show)&&(L=x.show),L?b("span",{key:K,class:S("action")},[x.render(a)]):null})}const Me=M(()=>{const a=Q(l.value);return Kt(a,(f,x)=>{var ae;const K=g.searchText,{highlight:L}=r(e),{title:v,key:B,children:N}=r(c),w=ve(f,f.icon),_=Nt(f,v),D=K?_.indexOf(K):-1,m=g.startSearch&&!vt(K)&&L&&D!==-1,H=`color: ${Se(L)?"#f50":L}`,Ie=m?b("span",{class:(ae=r(o))!=null&&ae.blockNode?`${S("content")}`:""},[b("span",null,[_.substr(0,D)]),b("span",{style:H},[K]),b("span",null,[_.substr(D+K.length)])]):_;return f.title=b("span",{class:`${S("title")} pl-2`,onClick:we.bind(null,f[B],f[N])},[n!=null&&n.title?Et(n,"title",f):b(W,null,[w&&b(Vt,{icon:w},null),Ie,b("span",{class:S("actions")},[Fe(f)])])]),f}),a});return A(De),()=>{let a;const{title:f,helpMessage:x,toolbar:K,search:L,checkable:v}=e,B=f||K||L||n.headerTitle,N={height:"calc(100% - 38px)"};return b("div",{class:[S(),"h-full",t.class]},[B&&b(Rt,{checkable:v,checkAll:le,expandAll:z,title:f,search:L,toolbar:K,helpMessage:x,onStrictlyChange:Be,onSearch:q,searchText:g.searchText},Ht(a=xt(n))?a:{default:()=>[a]}),b(bt,{spinning:r(e.loading),tip:"\u52A0\u8F7D\u4E2D..."},{default:()=>[ke(b(At,{style:N},{default:()=>[b(Tt,Ct(r(o),{showIcon:!1,treeData:Me.value}),null)]}),[[ge,!r(i)]]),ke(b(pe,{image:pe.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[ge,r(i)]])]})])}}});export{Jt as _};
