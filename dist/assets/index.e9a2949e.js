var Oe=Object.defineProperty,$e=Object.defineProperties;var Pe=Object.getOwnPropertyDescriptors;var ce=Object.getOwnPropertySymbols;var Ue=Object.prototype.hasOwnProperty,je=Object.prototype.propertyIsEnumerable;var se=(e,t,n)=>t in e?Oe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,I=(e,t)=>{for(var n in t||(t={}))Ue.call(t,n)&&se(e,n,t[n]);if(ce)for(var n of ce(t))je.call(t,n)&&se(e,n,t[n]);return e},re=(e,t)=>$e(e,Pe(t));var ie=(e,t,n)=>new Promise((y,L)=>{var S=g=>{try{p(n.next(g))}catch(b){L(b)}},c=g=>{try{p(n.throw(g))}catch(b){L(b)}},p=g=>g.done?y(g.value):Promise.resolve(g.value).then(S,c);p((n=n.apply(e,t)).next())});import{dj as Re,dk as Ve,dl as He,dm as Ye,dn as Xe,dp as me,cv as qe,cC as de,dq as ze,dr as Je,ds as We,dt as Ge,a as Ae,s as Ce,du as Ze,c as Qe,f as M,a6 as $,o as F,h as U,i as r,Z as et,k as O,j as J,y as j,z as oe,t as ue,cq as tt,q as he,n as C,dv as nt,E as G,Y as at,dw as lt,$ as ct,a0 as st,dx as rt,ao as it,an as Z,aD as dt,cW as ot,aM as ut,dy as ht,b9 as ft,a3 as Q,dz as fe,v as ye,Q as X,bU as yt,bx as kt,V as W,dA as pt,cR as gt,M as R,a5 as St,dB as Kt,cm as xt,bA as At,ah as Ct,w as ke,x as pe,aX as Lt,bT as bt,W as vt,dC as ge,bD as Et,dD as Tt,aJ as Se,bB as _t}from"./index.5903aaea.js";/* empty css                */import{u as Bt}from"./useContextMenu.3866e5b0.js";var Nt=200;function wt(e,t,n,y){var L=-1,S=Ye,c=!0,p=e.length,g=[],b=t.length;if(!p)return g;n&&(t=Re(t,Ve(n))),y?(S=Xe,c=!1):t.length>=Nt&&(S=me,c=!1,t=new He(t));e:for(;++L<p;){var s=e[L],o=n==null?s:n(s);if(s=y||s!==0?s:0,c&&o===o){for(var a=b;a--;)if(t[a]===o)continue e;g.push(s)}else S(t,o,y)||g.push(s)}return g}var Dt=qe(function(e,t){return de(e)?wt(e,ze(t,1,de,!0)):[]}),Ft=Dt;function Mt(e){for(var t=-1,n=e==null?0:e.length,y={};++t<n;){var L=e[t];y[L[0]]=L[1]}return y}function ee(e,t){return t?typeof t=="string"?` ${e}--${t}`:Array.isArray(t)?t.reduce((n,y)=>n+ee(e,y),""):Object.keys(t).reduce((n,y)=>n+(t[y]?ee(e,y):""),""):""}function It(e){return(t,n)=>(t&&typeof t!="string"&&(n=t,t=""),t=t?`${e}__${t}`:e,`${t}${ee(t,n)}`)}function Le(e){return[It(`${Je}-${e}`)]}const Ke=Symbol(),xe=Symbol();function Ot(e,t){if(!We(e)||!!e[xe])return e;const{values:n,required:y,default:L,type:S,validator:c}=e,p=n||c?g=>{let b=!1,s=[];if(n&&(s=[...n,L],b||(b=s.includes(g))),c&&(b||(b=c(g))),!b&&s.length>0){const o=[...new Set(s)].map(a=>JSON.stringify(a)).join(", ");Ge(`Invalid prop: validation failed${t?` for prop "${t}"`:""}. Expected one of [${o}], got value ${JSON.stringify(g)}.`)}return b}:void 0;return{type:typeof S=="object"&&Object.getOwnPropertySymbols(S).includes(Ke)?S[Ke]:S,required:!!y,default:L,validator:p,[xe]:!0}}const $t=e=>Mt(Object.entries(e).map(([t,n])=>[t,Ot(n,t)]));var T=(e=>(e[e.SELECT_ALL=0]="SELECT_ALL",e[e.UN_SELECT_ALL=1]="UN_SELECT_ALL",e[e.EXPAND_ALL=2]="EXPAND_ALL",e[e.UN_EXPAND_ALL=3]="UN_EXPAND_ALL",e[e.CHECK_STRICTLY=4]="CHECK_STRICTLY",e[e.CHECK_UN_STRICTLY=5]="CHECK_UN_STRICTLY",e))(T||{});const Pt=["update:expandedKeys","update:selectedKeys","update:value","change","check","update:searchValue"],Ut=$t({value:{type:[Object,Array]},renderIcon:{type:Function},helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:Boolean,search:Boolean,searchValue:{type:String,default:""},checkStrictly:Boolean,clickRowToExpand:{type:Boolean,default:!1},checkable:Boolean,defaultExpandLevel:{type:[String,Number],default:""},defaultExpandAll:Boolean,fieldNames:{type:Object},treeData:{type:Array},actionList:{type:Array,default:()=>[]},expandedKeys:{type:Array,default:()=>[]},selectedKeys:{type:Array,default:()=>[]},checkedKeys:{type:Array,default:()=>[]},beforeRightClick:{type:Function,default:void 0},rightMenuList:{type:Array},filterFn:{type:Function,default:void 0},highlight:{type:[Boolean,String],default:!1},expandOnSearch:Boolean,checkOnSearch:Boolean,selectedOnSearch:Boolean,loading:{type:Boolean,default:!1}}),jt={key:2,class:"flex items-center flex-1 cursor-pointer justify-self-stretch"},Rt=Ae({props:{helpMessage:{type:[String,Array],default:""},title:{type:String,default:""},toolbar:{type:Boolean,default:!1},checkable:{type:Boolean,default:!1},search:{type:Boolean,default:!1},searchText:{type:String,default:""},checkAll:{type:Function,default:void 0},expandAll:{type:Function,default:void 0}},emits:["strictly-change","search"],setup(e,{emit:t}){const n=e,y=Ce(""),[L]=Le("tree-header"),S=Ze(),{t:c}=Qe(),p=M(()=>{const a=S.headerTitle||n.title;return["mr-1","w-full",{["ml-5"]:a}]}),g=M(()=>{const{checkable:a}=n,i=[{label:c("component.tree.expandAll"),value:T.EXPAND_ALL},{label:c("component.tree.unExpandAll"),value:T.UN_EXPAND_ALL,divider:a}];return a?[{label:c("component.tree.selectAll"),value:T.SELECT_ALL},{label:c("component.tree.unSelectAll"),value:T.UN_SELECT_ALL,divider:a},...i,{label:c("component.tree.checkStrictly"),value:T.CHECK_STRICTLY},{label:c("component.tree.checkUnStrictly"),value:T.CHECK_UN_STRICTLY}]:i});function b(a){var d,h,u,k;const{key:i}=a;switch(i){case T.SELECT_ALL:(d=n.checkAll)==null||d.call(n,!0);break;case T.UN_SELECT_ALL:(h=n.checkAll)==null||h.call(n,!1);break;case T.EXPAND_ALL:(u=n.expandAll)==null||u.call(n,!0);break;case T.UN_EXPAND_ALL:(k=n.expandAll)==null||k.call(n,!1);break;case T.CHECK_STRICTLY:t("strictly-change",!1);break;case T.CHECK_UN_STRICTLY:t("strictly-change",!0);break}}function s(a){t("search",a)}const o=ut(s,200);return $(()=>y.value,a=>{o(a)}),$(()=>n.searchText,a=>{a!==y.value&&(y.value=a)}),(a,i)=>(F(),U("div",{class:he([r(L)(),"flex px-2 py-1.5 items-center"])},[r(S).headerTitle?et(a.$slots,"headerTitle",{key:0}):O("",!0),!r(S).headerTitle&&a.title?(F(),J(r(tt),{key:1,helpMessage:a.helpMessage},{default:j(()=>[oe(ue(a.title),1)]),_:1},8,["helpMessage"])):O("",!0),a.search||a.toolbar?(F(),U("div",jt,[a.search?(F(),U("div",{key:0,class:he(r(p))},[C(r(nt),{placeholder:r(c)("common.searchText"),size:"small",allowClear:"",value:y.value,"onUpdate:value":i[0]||(i[0]=d=>y.value=d)},null,8,["placeholder","value"])],2)):O("",!0),a.toolbar?(F(),J(r(ot),{key:1,onClick:i[1]||(i[1]=dt(()=>{},["prevent"]))},{overlay:j(()=>[C(r(it),{onClick:b},{default:j(()=>[(F(!0),U(G,null,at(r(g),d=>(F(),U(G,{key:d.value},[C(r(lt),ct(st({key:d.value})),{default:j(()=>[oe(ue(d.label),1)]),_:2},1040),d.divider?(F(),J(r(rt),{key:0})):O("",!0)],64))),128))]),_:1})]),default:j(()=>[C(r(Z),{icon:"ion:ellipsis-vertical"})]),_:1})):O("",!0)])):O("",!0)],2))}}),Vt=({icon:e})=>e?ht(e)?ft(Z,{icon:e,class:"mr-1"}):Z:null;function Ht(e,t){function n(s){const o=[],a=s||r(e),{key:i,children:d}=r(t);if(!d||!i)return o;for(let h=0;h<a.length;h++){const u=a[h];o.push(u[i]);const k=u[d];k&&k.length&&o.push(...n(k))}return o}function y(s){const o=[],a=s||r(e),{key:i,children:d}=r(t);if(!d||!i)return o;for(let h=0;h<a.length;h++){const u=a[h];u.disabled!==!0&&u.selectable!==!1&&o.push(u[i]);const k=u[d];k&&k.length&&o.push(...y(k))}return o}function L(s,o){const a=[],i=o||r(e),{key:d,children:h}=r(t);if(!h||!d)return a;for(let u=0;u<i.length;u++){const k=i[u],E=k[h];s===k[d]?(a.push(k[d]),E&&E.length&&a.push(...n(E))):E&&E.length&&a.push(...L(s,E))}return a}function S(s,o,a){if(!s)return;const i=a||r(e),{key:d,children:h}=r(t);if(!(!h||!d))for(let u=0;u<i.length;u++){const k=i[u],E=k[h];if(k[d]===s){i[u]=I(I({},i[u]),o);break}else E&&E.length&&S(s,o,k[h])}}function c(s=1,o,a=1){if(!s)return[];const i=[],d=o||r(e)||[];for(let h=0;h<d.length;h++){const u=d[h],{key:k,children:E}=r(t),m=k?u[k]:"",P=E?u[E]:[];i.push(m),P&&P.length&&a<s&&(a+=1,i.push(...c(s,P,a)))}return i}function p({parentKey:s=null,node:o,push:a="push"}){const i=Q(r(e));if(!s){i[a](o),e.value=i;return}const{key:d,children:h}=r(t);!h||!d||(fe(i,u=>{if(u[d]===s)return u[h]=u[h]||[],u[h][a](o),!0}),e.value=i)}function g({parentKey:s=null,list:o,push:a="push"}){const i=Q(r(e));if(!(!o||o.length<1))if(s){const{key:d,children:h}=r(t);if(!h||!d)return;fe(i,u=>{if(u[d]===s){u[h]=u[h]||[];for(let k=0;k<o.length;k++)u[h][a](o[k]);return e.value=i,!0}})}else for(let d=0;d<o.length;d++)i[a](o[d])}function b(s,o){if(!s)return;const a=o||r(e),{key:i,children:d}=r(t);if(!(!d||!i))for(let h=0;h<a.length;h++){const u=a[h],k=u[d];if(u[i]===s){a.splice(h,1);break}else k&&k.length&&b(s,u[d])}}return{deleteNodeByKey:b,insertNodeByKey:p,insertNodesByKey:g,filterByLevel:c,updateNodeByKey:S,getAllKeys:n,getChildrenKeys:L,getEnabledKeys:y}}function Yt(e){return typeof e=="function"||Object.prototype.toString.call(e)==="[object Object]"&&!At(e)}var Jt=Ae({name:"BasicTree",inheritAttrs:!1,props:Ut,emits:Pt,setup(e,{attrs:t,slots:n,emit:y,expose:L}){const[S]=Le("tree"),c=ye({checkStrictly:e.checkStrictly,expandedKeys:e.expandedKeys||[],selectedKeys:e.selectedKeys||[],checkedKeys:e.checkedKeys||[]}),p=ye({startSearch:!1,searchText:"",searchData:[]}),g=Ce([]),[b]=Bt(),s=M(()=>{const{fieldNames:l}=e;return I({children:"children",title:"title",key:"key"},l)}),o=M(()=>{let l=re(I(I({blockNode:!0},t),e),{expandedKeys:c.expandedKeys,selectedKeys:c.selectedKeys,checkedKeys:c.checkedKeys,checkStrictly:c.checkStrictly,filedNames:r(s),"onUpdate:expandedKeys":f=>{c.expandedKeys=f,y("update:expandedKeys",f)},"onUpdate:selectedKeys":f=>{c.selectedKeys=f,y("update:selectedKeys",f)},onCheck:(f,x)=>{let K=X(c.checkedKeys);if(yt(K)&&p.startSearch){const{key:v}=r(s);K=Ft(K,P(x.node.$attrs.node[v])),x.checked&&K.push(x.node.$attrs.node[v]),c.checkedKeys=K}else c.checkedKeys=f;const A=X(c.checkedKeys);y("update:value",A),y("check",A,x)},onRightClick:Ee});return kt(l,"treeData","class")}),a=M(()=>p.startSearch?p.searchData:r(g)),i=M(()=>!a.value||a.value.length===0),{deleteNodeByKey:d,insertNodeByKey:h,insertNodesByKey:u,filterByLevel:k,updateNodeByKey:E,getAllKeys:m,getChildrenKeys:P,getEnabledKeys:be}=Ht(g,s);function ve(l,f){return!f&&e.renderIcon&&W(e.renderIcon)?e.renderIcon(l):f}function Ee(x){return ie(this,arguments,function*({event:l,node:f}){var N;const{rightMenuList:K=[],beforeRightClick:A}=e;let v={event:l,items:[]};if(A&&W(A)){let B=yield A(f,l);Array.isArray(B)?v.items=B:Object.assign(v,B)}else v.items=K;!((N=v.items)!=null&&N.length)||b(v)})}function V(l){c.expandedKeys=l}function Te(){return c.expandedKeys}function te(l){c.selectedKeys=l}function _e(){return c.selectedKeys}function ne(l){c.checkedKeys=l}function Be(){return c.checkedKeys}function ae(l){c.checkedKeys=l?be():[]}function q(l){c.expandedKeys=l?m():[]}function Ne(l){c.checkStrictly=l}$(()=>e.searchValue,l=>{l!==p.searchText&&(p.searchText=l)},{immediate:!0}),$(()=>e.treeData,l=>{l&&z(p.searchText)});function z(l){if(l!==p.searchText&&(p.searchText=l),y("update:searchValue",l),!l){p.startSearch=!1;return}const{filterFn:f,checkable:x,expandOnSearch:K,checkOnSearch:A,selectedOnSearch:v}=r(e);p.startSearch=!0;const{title:N,key:B}=r(s),w=[];if(p.searchData=pt(r(g),_=>{var H,Y;const D=f?f(l,_,r(s)):(Y=(H=_[N])==null?void 0:H.includes(l))!=null?Y:!1;return D&&w.push(_[B]),D},r(s)),K){const _=gt(p.searchData).map(D=>D[B]);_&&_.length&&V(_)}A&&x&&w.length&&ne(w),v&&w.length&&te(w)}function we(l,f){if(!(!e.clickRowToExpand||!f||f.length===0))if(!c.expandedKeys.includes(l))V([...c.expandedKeys,l]);else{const x=[...c.expandedKeys],K=x.findIndex(A=>A===l);K!==-1&&x.splice(K,1),V(x)}}R(()=>{g.value=e.treeData}),St(()=>{const l=parseInt(e.defaultExpandLevel);l>0?c.expandedKeys=k(l):e.defaultExpandAll&&q(!0)}),R(()=>{c.expandedKeys=e.expandedKeys}),R(()=>{c.selectedKeys=e.selectedKeys}),R(()=>{c.checkedKeys=e.checkedKeys}),$(()=>e.value,()=>{c.checkedKeys=X(e.value||[])}),$(()=>c.checkedKeys,()=>{const l=X(c.checkedKeys);y("update:value",l),y("change",l)}),R(()=>{c.checkStrictly=e.checkStrictly});const De={setExpandedKeys:V,getExpandedKeys:Te,setSelectedKeys:te,getSelectedKeys:_e,setCheckedKeys:ne,getCheckedKeys:Be,insertNodeByKey:h,insertNodesByKey:u,deleteNodeByKey:d,updateNodeByKey:E,checkAll:ae,expandAll:q,filterByLevel:l=>{c.expandedKeys=k(l)},setSearchValue:l=>{z(l)},getSearchValue:()=>p.searchText};function Fe(l){const{actionList:f}=e;if(!(!f||f.length===0))return f.map((x,K)=>{var v;let A=!0;return W(x.show)?A=(v=x.show)==null?void 0:v.call(x,l):Se(x.show)&&(A=x.show),A?C("span",{key:K,class:S("action")},[x.render(l)]):null})}const Me=M(()=>{const l=Q(a.value);return Kt(l,(f,x)=>{var le;const K=p.searchText,{highlight:A}=r(e),{title:v,key:N,children:B}=r(s),w=ve(f,f.icon),_=Et(f,v),D=K?_.indexOf(K):-1,H=p.startSearch&&!Tt(K)&&A&&D!==-1,Y=`color: ${Se(A)?"#f50":A}`,Ie=H?C("span",{class:(le=r(o))!=null&&le.blockNode?`${S("content")}`:""},[C("span",null,[_.substr(0,D)]),C("span",{style:Y},[K]),C("span",null,[_.substr(D+K.length)])]):_;return f.title=C("span",{class:`${S("title")} pl-2`,onClick:we.bind(null,f[N],f[B])},[n!=null&&n.title?_t(n,"title",f):C(G,null,[w&&C(Vt,{icon:w},null),Ie,C("span",{class:S("actions")},[Fe(f)])])]),f}),l});return L(De),()=>{let l;const{title:f,helpMessage:x,toolbar:K,search:A,checkable:v}=e,N=f||K||A||n.headerTitle,B={height:"calc(100% - 38px)"};return C("div",{class:[S(),"h-full",t.class]},[N&&C(Rt,{checkable:v,checkAll:ae,expandAll:q,title:f,search:A,toolbar:K,helpMessage:x,onStrictlyChange:Ne,onSearch:z,searchText:p.searchText},Yt(l=xt(n))?l:{default:()=>[l]}),C(Ct,{spinning:r(e.loading),tip:"\u52A0\u8F7D\u4E2D..."},{default:()=>[ke(C(Lt,{style:B},{default:()=>[C(bt,vt(r(o),{showIcon:!1,treeData:Me.value}),null)]}),[[pe,!r(i)]]),ke(C(ge,{image:ge.PRESENTED_IMAGE_SIMPLE,class:"!mt-4"},null),[[pe,r(i)]])]})])}}});export{Jt as _};
