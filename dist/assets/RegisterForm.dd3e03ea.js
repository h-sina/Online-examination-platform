var B=(F,s,t)=>new Promise((c,m)=>{var C=e=>{try{r(t.next(e))}catch(l){m(l)}},f=e=>{try{r(t.throw(e))}catch(l){m(l)}},r=e=>e.done?c(e.value):Promise.resolve(e.value).then(C,f);r((t=t.apply(F,s)).next())});import{u as b,a as z,L as R,_ as h,b as L}from"./LoginFormTitle.faf78e9c.js";import{a as U,F as A,I as g,c as V,r as M,s as E,v as N,f as Z,i as a,J as $,o as G,h as P,n as o,y as n,B as y,z as p,t as _,E as q,k as H,H as J}from"./index.572c67d6.js";/* empty css               *//* empty css               */import{r as j,v as K,e as O}from"./account.4a9e24b7.js";const Q=p("\u9A8C\u8BC1\u9080\u8BF7\u7801"),W=p("\u83B7\u53D6\u9A8C\u8BC1\u7801"),oe=U({setup(F){const{notification:s}=J(),t=A.Item;g.Password;const{t:c}=V(),{handleBackLogin:m,getLoginState:C}=b();M();const f=E(),r=E(!1),e=N({invitationCode:"",email:"",emailCode:"",userId:"",account:"",password:"",confirmPassword:"",mobile:"",sms:"",policy:!1}),l=E(),{getFormRules:x}=z(e),{validForm:I}=L(f),k=Z(()=>a(C)===R.REGISTER);function S(){return B(this,null,function*(){yield I();try{(yield j(e.emailCode,e.email,e.userId)).code==="ITEST-200"?s.success({message:"\u6CE8\u518C\u6210\u529F",duration:3}):s.error({message:"\u6CE8\u518C\u5931\u8D25",duration:3})}catch(u){s.error({message:"\u51FA\u9519\u8BEF\u5566",description:u,duration:3})}finally{r.value=!1}})}function w(){return B(this,null,function*(){if(e.invitationCode=="")s.error({message:"\u9080\u8BF7\u7801\u4E0D\u80FD\u4E3A\u7A7A",duration:3});else try{const u=yield K(e.invitationCode);u.code==="ITEST-200"?(s.success({message:"\u9080\u8BF7\u7801\u6B63\u786E",description:"\u8BF7\u7EE7\u7EED\u586B\u5199\u90AE\u7BB1",duration:3}),l.value="ITEST-REGISTER-1",e.userId=u.data):s.error({message:"\u9080\u8BF7\u7801\u5931\u6548",description:"\u8BF7\u91CD\u65B0\u8F93\u5165\u65B0\u7684\u9080\u8BF7\u7801",duration:3})}catch(u){createErrorModal({title:c("sys.api.errorTip"),content:u.message||c("sys.api.networkExceptionMsg"),getContainer:()=>document.body.querySelector(`.${prefixCls}`)||document.body})}finally{r.value=!1}})}function D(u){var i=/^([a-zA-Z]|[0-9])(\w|\-)+@[a-zA-Z0-9]+\.([a-zA-Z]{2,4})$/;return i.test(u)}function T(){return B(this,null,function*(){if(e.email=="")s.error({message:"\u51FA\u9519\u8BEF\u5566",description:"\u90AE\u7BB1\u4E0D\u80FD\u4E3A\u7A7A",duration:3});else if(D(e.email)==!1)s.error({message:"\u8BF7\u586B\u5199\u6B63\u786E\u7684\u90AE\u7BB1",duration:3});else if(l.value=="")s.error({message:"\u51FA\u9519\u8BEF\u5566",description:"\u8BF7\u5148\u9A8C\u8BC1\u9080\u8BF7\u7801",duration:3});else try{const u=yield O(e.email,l.value);u.code==="ITEST-200"?s.success({message:"\u90AE\u7BB1\u6B63\u786E",description:"\u5DF2\u53D1\u9001\u9A8C\u8BC1\u7801\u5230\u90AE\u7BB1",duration:3}):s.error({message:u.msg,duration:3})}catch(u){s.error({message:"\u51FA\u9519\u8BEF\u5566",description:u,duration:3})}finally{r.value=!1}})}return(u,i)=>{const v=$("a-button");return a(k)?(G(),P(q,{key:0},[o(h,{class:"enter-x"}),o(a(A),{class:"p-4 enter-x",model:a(e),rules:a(x),ref_key:"formRef",ref:f},{default:n(()=>[o(a(t),{name:"invitationCode",class:"enter-x"},{default:n(()=>[o(a(g),{size:"large",value:a(e).invitationCode,"onUpdate:value":i[0]||(i[0]=d=>a(e).invitationCode=d),placeholder:"\u9080\u8BF7\u7801",class:"fix-auto-fill"},null,8,["value"]),o(v,{color:"warning",onClick:w},{default:n(()=>[Q]),_:1})]),_:1}),o(a(t),{name:"email",class:"enter-x"},{default:n(()=>[o(a(g),{size:"large",value:a(e).email,"onUpdate:value":i[1]||(i[1]=d=>a(e).email=d),placeholder:"\u90AE\u7BB1",class:"fix-auto-fill"},null,8,["value"]),o(v,{color:"warning",onClick:T},{default:n(()=>[W]),_:1})]),_:1}),o(a(t),{name:"emailCode",class:"enter-x"},{default:n(()=>[o(a(g),{size:"large",value:a(e).emailCode,"onUpdate:value":i[2]||(i[2]=d=>a(e).emailCode=d),placeholder:"\u90AE\u7BB1\u9A8C\u8BC1\u7801",class:"fix-auto-fill"},null,8,["value"])]),_:1}),o(a(y),{type:"primary",class:"enter-x",size:"large",block:"",onClick:S,loading:r.value},{default:n(()=>[p(_(a(c)("sys.login.registerButton")),1)]),_:1},8,["loading"]),o(a(y),{size:"large",block:"",class:"mt-4 enter-x",onClick:a(m)},{default:n(()=>[p(_(a(c)("sys.login.backSignIn")),1)]),_:1},8,["onClick"])]),_:1},8,["model","rules"])],64)):H("",!0)}}});export{oe as default};
