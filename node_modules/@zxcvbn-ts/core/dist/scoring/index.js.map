{"version":3,"file":"index.js","sources":["../../src/scoring/index.ts"],"sourcesContent":[null],"names":["scoringHelper","password","optimal","excludeAdditive","fillArray","size","valueType","result","i","value","push","makeBruteforceMatch","j","pattern","token","slice","update","match","sequenceLength","k","estimatedMatch","estimateGuesses","pi","guesses","g","utils","factorial","MIN_GUESSES_BEFORE_GROWING_SEQUENCE","shouldSkip","Object","keys","forEach","competingPatternLength","competingMetricMatch","parseInt","m","bruteforceUpdate","passwordCharIndex","tmp","lastMatch","unwind","passwordLength","optimalMatchSequence","temp","candidateSequenceLength","candidateMetricMatch","unshift","mostGuessableMatchSequence","matches","length","matchesByCoordinateJ","map","sort","m1","m2","optimalSequenceLength","getGuesses","guessesLog10","log10","sequence"],"mappings":"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"}